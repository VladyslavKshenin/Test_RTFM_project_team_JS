import{g as L,m as r,a as u,b as T,c as f,d as E}from"./assets/applebooks@2x-32274212.js";const B="https://books-backend.p.goit.global/books",I={list:"category-list",top:"top-books",category:"category?category="};async function v(e,t=""){try{return await(await fetch(`${B}/${e}${t}`)).json()}catch{alert("An error occurred")}}async function $(e){try{return await(await fetch(`${B}/${e}`)).json()}catch{alert("An error occurred")}}const s={API_OPTIONS:I,fetchBookList:v,fetchBookById:$},O=document.querySelector(".ctg-list");s.fetchBookList(s.API_OPTIONS.list).then(e=>{const t=e.map(({list_name:o})=>`<li class="ctg-item js-ctg-item " data-ctg-name = ${o}>${o}
          </li>`).join("");O.insertAdjacentHTML("beforeend",t)});const i=L();s.fetchBookList(s.API_OPTIONS.top).then(r.renderTopBooks);function b(e){[...i.ctgList.children].forEach(t=>t.classList.remove("ctg-item-active")),i.ctgList.contains(e.target)?e.target.classList.add("ctg-item-active"):[...i.ctgList.children].find(o=>o.textContent.trim()===e.target.dataset.category).classList.add("ctg-item-active")}function x(e){const t=e.target.childNodes[0].data;b(e),t!=="All categories"?s.fetchBookList(s.API_OPTIONS.category,t).then(r.renderCategoryBooks):s.fetchBookList(s.API_OPTIONS.top).then(r.renderTopBooks)}function C(e){if(!e.target.classList.contains("top-books-button"))return;const t=e.target.dataset.category;b(e),s.fetchBookList(s.API_OPTIONS.category,t).then(r.renderCategoryBooks)}i.ctgList.addEventListener("click",x);i.bookCollectionWrapper.addEventListener("click",C);const A=L(),l=document.getElementById("bookModal"),p=document.getElementById("bookModalTitle"),M=document.getElementById("bookModalBody"),a=document.getElementById("addToShoppingList"),_=document.querySelector(".modal-close"),d=document.getElementById("modalFooterText");let n=[],c=[],w={};const N="The Duke of Sussex details his struggles with the royal family, loss of his mother, service in the British Army and marriage to Meghan Markle. Read by the author. 15 hours, 39 minutes unabridged.";function P(e){s.fetchBookById(e).then(t=>{p.innerText=t.title,t.description||(t.description=N),w={book_image:t.book_image,title:t.title,author:t.author,description:t.description,amazonLinks:t.buy_links[0].url,appleLinks:t.buy_links[1].url},p.dataset.bookId=e,M.innerHTML=`<img src="${t.book_image}" alt="${t.title}" class="book-modal-img"/>
            <div class="book-modal-details">
                <h2 class="book-modal-title">${t.title}</h2>
                <h3 class="book-modal-author">${t.author}</h3>
                <p class="book-modal-desc">${t.description}</p>
                <ul class="icon-book-modal-list">
                    <li>
                        <a href="${t.buy_links[0].url}" rel="noopener noreferrer nofollow" target="_blank">
                            <img class="icon-book-modal-amazon" srcset="${u} 1x, ${T} 2x" src="${u}" alt="Amazon" loading="lazy"/>
                        </a>
                    </li>
                    <li>
                        <a href="${t.buy_links[1].url}" rel="noopener noreferrer nofollow" target="_blank">
                            <img class="icon-book-modal-ibooks" srcset="${f} 1x, ${E} 2x" src="${f}" alt="Apple books" loading="lazy"/>
                        </a>
                    </li>
                </ul>
            </div>
    `,n.includes(e)?(a.innerText="Remove from the shopping list",d.style.display="block"):(a.innerText="Add to shopping list",d.style.display="none"),l.classList.add("show"),document.body.style.overflow="hidden"})}function m(){l.classList.remove("show"),document.body.style.overflow=""}function z(e){if(!e){console.error("Invalid bookId:",e);return}const t=n.indexOf(e);t===-1?(n.push(e),c.push(w)):(n.splice(t,1),c.splice(t,1)),localStorage.setItem("shoppingList",JSON.stringify(n)),localStorage.setItem("shoppingCard",JSON.stringify(c)),t===-1?(a.innerText="Remove from the shopping list",d.style.display="block"):(a.innerText="Add to shopping list",d.style.display="none")}a.addEventListener("click",()=>{const e=p.dataset.bookId;z(e)});l.addEventListener("click",e=>{e.target===l&&m()});document.addEventListener("keydown",e=>{e.key==="Escape"&&m()});A.bookCollectionWrapper.addEventListener("click",e=>{const t=e.target.closest(".book-link");if(t){e.preventDefault();const o=t.dataset.id;P(o)}});const y=localStorage.getItem("shoppingList"),k=localStorage.getItem("shoppingCard");y&&(n=JSON.parse(y));k&&(c=JSON.parse(k));_.addEventListener("click",m);document.addEventListener("DOMContentLoaded",function(){document.getElementById("signupBtn").addEventListener("click",t);function t(){fetch("/partials/registration.html").then(o=>{if(!o.ok)throw new Error(`Network response was not ok: ${o.status}`);return o.text()}).then(o=>{const g=document.createElement("div");g.innerHTML=o,document.body.appendChild(g),console.log("Модальное окно регистрации открыто!")}).catch(o=>{console.error("Error fetching registration.html:",o)})}});const h=document.querySelector(".back-to-top");window.addEventListener("scroll",R);h.addEventListener("click",S);function R(){const e=window.pageYOffset,t=document.documentElement.clientHeight;e>t?h.classList.add("back-to-top--show"):h.classList.remove("back-to-top--show")}function S(){window.pageYOffset>0&&(window.scrollBy(0,-25),setTimeout(S,0))}
//# sourceMappingURL=commonHelpers.js.map
