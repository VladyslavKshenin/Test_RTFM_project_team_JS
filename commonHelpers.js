import{g as S,m as p,a as b,b as P,c as E,d as _}from"./assets/applebooks@2x-32274212.js";const w="https://books-backend.p.goit.global/books",N={list:"category-list",top:"top-books",category:"category?category="};async function z(e,t=""){try{return await(await fetch(`${w}/${e}${t}`)).json()}catch{alert("An error occurred")}}async function R(e){try{return await(await fetch(`${w}/${e}`)).json()}catch{alert("An error occurred")}}const n={API_OPTIONS:N,fetchBookList:z,fetchBookById:R},j=document.querySelector(".ctg-list");n.fetchBookList(n.API_OPTIONS.list).then(e=>{const t=e.map(({list_name:o})=>`<li class="ctg-item js-ctg-item " data-ctg-name = ${o}>${o}
          </li>`).join("");j.insertAdjacentHTML("beforeend",t)});const c=S();n.fetchBookList(n.API_OPTIONS.top).then(p.renderTopBooks);function T(e){[...c.ctgList.children].forEach(t=>t.classList.remove("ctg-item-active")),c.ctgList.contains(e.target)?e.target.classList.add("ctg-item-active"):[...c.ctgList.children].find(o=>o.textContent.trim()===e.target.dataset.category).classList.add("ctg-item-active")}function D(e){const t=e.target.childNodes[0].data;T(e),t!=="All categories"?n.fetchBookList(n.API_OPTIONS.category,t).then(p.renderCategoryBooks):n.fetchBookList(n.API_OPTIONS.top).then(p.renderTopBooks)}function q(e){if(!e.target.classList.contains("top-books-button"))return;const t=e.target.dataset.category;T(e),n.fetchBookList(n.API_OPTIONS.category,t).then(p.renderCategoryBooks)}c.ctgList.addEventListener("click",D);c.bookCollectionWrapper.addEventListener("click",q);const F=S(),u=document.getElementById("bookModal"),y=document.getElementById("bookModalTitle"),H=document.getElementById("bookModalBody"),l=document.getElementById("addToShoppingList"),J=document.querySelector(".modal-close"),h=document.getElementById("modalFooterText");let a=[],m=[],x={};const U="The Duke of Sussex details his struggles with the royal family, loss of his mother, service in the British Army and marriage to Meghan Markle. Read by the author. 15 hours, 39 minutes unabridged.";function W(e){n.fetchBookById(e).then(t=>{y.innerText=t.title,t.description||(t.description=U),x={book_image:t.book_image,title:t.title,author:t.author,description:t.description,amazonLinks:t.buy_links[0].url,appleLinks:t.buy_links[1].url},y.dataset.bookId=e,H.innerHTML=`<img src="${t.book_image}" alt="${t.title}" class="book-modal-img"/>
            <div class="book-modal-details">
                <h2 class="book-modal-title">${t.title}</h2>
                <h3 class="book-modal-author">${t.author}</h3>
                <p class="book-modal-desc">${t.description}</p>
                <ul class="icon-book-modal-list">
                    <li>
                        <a href="${t.buy_links[0].url}" rel="noopener noreferrer nofollow" target="_blank">
                            <img class="icon-book-modal-amazon" srcset="${b} 1x, ${P} 2x" src="${b}" alt="Amazon" loading="lazy"/>
                        </a>
                    </li>
                    <li>
                        <a href="${t.buy_links[1].url}" rel="noopener noreferrer nofollow" target="_blank">
                            <img class="icon-book-modal-ibooks" srcset="${E} 1x, ${_} 2x" src="${E}" alt="Apple books" loading="lazy"/>
                        </a>
                    </li>
                </ul>
            </div>
    `,a.includes(e)?(l.innerText="Remove from the shopping list",h.style.display="block"):(l.innerText="Add to shopping list",h.style.display="none"),u.classList.add("show"),document.body.style.overflow="hidden"})}function k(){u.classList.remove("show"),document.body.style.overflow=""}function Y(e){if(!e){console.error("Invalid bookId:",e);return}const t=a.indexOf(e);t===-1?(a.push(e),m.push(x)):(a.splice(t,1),m.splice(t,1)),localStorage.setItem("shoppingList",JSON.stringify(a)),localStorage.setItem("shoppingCard",JSON.stringify(m)),t===-1?(l.innerText="Remove from the shopping list",h.style.display="block"):(l.innerText="Add to shopping list",h.style.display="none")}l.addEventListener("click",()=>{const e=y.dataset.bookId;Y(e)});u.addEventListener("click",e=>{e.target===u&&k()});document.addEventListener("keydown",e=>{e.key==="Escape"&&k()});F.bookCollectionWrapper.addEventListener("click",e=>{const t=e.target.closest(".book-link");if(t){e.preventDefault();const o=t.dataset.id;W(o)}});const I=localStorage.getItem("shoppingList"),v=localStorage.getItem("shoppingCard");I&&(a=JSON.parse(I));v&&(m=JSON.parse(v));J.addEventListener("click",k);document.addEventListener("DOMContentLoaded",function(){const e=document.createElement("meta");e.httpEquiv="Content-Security-Policy",e.content="default-src 'none'; style-src 'unsafe-inline'; img-src data:; connect-src 'self'",document.head.appendChild(e),document.getElementById("signupBtn").addEventListener("click",L);const o=document.createElement("div");o.style.position="fixed",o.style.top="20px",o.style.right="20px",o.style.background="red",o.style.color="white",o.style.padding="15px",o.style.display="none",o.style.zIndex="1",document.body.appendChild(o);function L(){fetch("/partials/registration.html").then(s=>s.text()).then(s=>{const M=document.getElementById("registrationModalContainer");M.innerHTML=s;const $=document.getElementById("registrationForm"),O=document.querySelector(".close-icon");$.addEventListener("submit",function(A){A.preventDefault();const r=document.getElementById("name").value,d=document.getElementById("email").value,g=document.getElementById("password").value;if(r&&d&&g){console.log("User data:",{name:r,email:d,password:g});const i={name:r,email:d,password:g};localStorage.setItem("userData",JSON.stringify(i)),B()}else{const i=[];r||i.push("Name"),d||i.push("Email"),g||i.push("Password"),o.textContent=`Please fill in the following fields: ${i.join(", ")}`,o.style.display="block",setTimeout(function(){o.style.display="none"},1e4)}}),O.addEventListener("click",function(){o.style.display="none",B()})}).catch(s=>console.error("Error loading registration content:",s))}function B(){const s=document.getElementById("registrationModalContainer");s.innerHTML=""}});const f=document.querySelector(".back-to-top");window.addEventListener("scroll",G);f.addEventListener("click",C);function G(){const e=window.pageYOffset,t=document.documentElement.clientHeight;e>t?f.classList.add("back-to-top--show"):f.classList.remove("back-to-top--show")}function C(){window.pageYOffset>0&&(window.scrollBy(0,-25),setTimeout(C,0))}
//# sourceMappingURL=commonHelpers.js.map
